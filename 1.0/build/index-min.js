/*! notification - v1.0 - 2013-05-21 10:31:10 PM
* Copyright (c) 2013 踏风; Licensed  */
KISSY.add("gallery/notification/1.0/notification",function(){function i(i,t){this._title=i,this._options=t,this._instance=null,this._events={show:[],close:[],click:[],error:[]};var n=this;this._router=function(i){n._events[i.type].forEach(function(t){t.call(n,i)})},t.autoShow&&this.show()}var t=window.Notification,n=window.webkitNotifications;return i.prototype={constructor:i,show:function(){var i=this._options;return t?(this._instance=t&&new t(this._title,i),this._initEvents()):(this._instance=n.createNotification(i.icon,this._title,i.body),this._instance.dir=i.dir,this._initEvents(),this._instance.show()),this},_initEvents:function(){var i=this._instance,t=this._events;for(var n in t)i.addEventListener(n,this._router,!1)},close:function(){this._instance&&this._instance.close()},on:function(i,t){if(!this._events[i])throw Error("Unsupported events:"+i);return this._events[i].push(t),this},off:function(i,t){if(!this._events[i])throw Error("Unsupported events:"+i);var n,s=this._events[i];return t?(n=s.indexOf(t),n>-1&&s.splice(n,1)):this._events[i]=[],this}},i.show=function(i,s,e){t&&new t(i,{body:s,icon:e})||n&&new n.createNotification(e,i,s).show()},i.checkPermission=function(){},i.isPermitted=function(){return t.permission&&"granted"===t.permission||0==n.checkPermission()},i.requestPermission=function(i){return(t||n).requestPermission(i),this},i.isSupport=function(){return"Notification"in window||"webkitNotifications"in window},i}),KISSY.add("gallery/notification/1.0/index",function(i,t){return t},{requires:["./notification"]});